-- AM BOT SCRIPT
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")

local player = Players.LocalPlayer
local camera = Workspace.CurrentCamera

local isAutoClicking = false
local isAutoAiming = false
local isUIVisible = true
local connection1, connection2 = nil, nil

-- T·∫°o giao di·ªán
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AmbotGUI"
screenGui.Parent = game:GetService("CoreGui") or player.PlayerGui

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 180, 0, 130)
mainFrame.Position = UDim2.new(0, 10, 0, 10)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
mainFrame.BorderSizePixel = 2
mainFrame.BorderColor3 = Color3.fromRGB(80, 80, 120)
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = screenGui

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 25)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundColor3 = Color3.fromRGB(50, 50, 70)
title.TextColor3 = Color3.fromRGB(255, 100, 100)
title.Text = "üü• AM BOT v2.0 üü•"
title.Font = Enum.Font.SourceSansBold
title.TextSize = 16
title.Parent = mainFrame

-- N√∫t Auto Click
local autoClickButton = Instance.new("TextButton")
autoClickButton.Size = UDim2.new(0.9, 0, 0, 30)
autoClickButton.Position = UDim2.new(0.05, 0, 0.25, 0)
autoClickButton.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
autoClickButton.TextColor3 = Color3.fromRGB(255, 255, 255)
autoClickButton.Text = "üî´ AUTO CLICK: OFF"
autoClickButton.Font = Enum.Font.SourceSansBold
autoClickButton.TextSize = 14
autoClickButton.Parent = mainFrame

-- N√∫t Auto Aim
local autoAimButton = Instance.new("TextButton")
autoAimButton.Size = UDim2.new(0.9, 0, 0, 30)
autoAimButton.Position = UDim2.new(0.05, 0, 0.5, 0)
autoAimButton.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
autoAimButton.TextColor3 = Color3.fromRGB(255, 255, 255)
autoAimButton.Text = "üéØ AUTO AIM: OFF"
autoAimButton.Font = Enum.Font.SourceSansBold
autoAimButton.TextSize = 14
autoAimButton.Parent = mainFrame

-- N√∫t ·∫®n/Hi·ªán UI
local hideUIButton = Instance.new("TextButton")
hideUIButton.Size = UDim2.new(0.9, 0, 0, 25)
hideUIButton.Position = UDim2.new(0.05, 0, 0.75, 0)
hideUIButton.BackgroundColor3 = Color3.fromRGB(80, 60, 80)
hideUIButton.TextColor3 = Color3.fromRGB(255, 255, 255)
hideUIButton.Text = "üëÅÔ∏è HIDE UI"
hideUIButton.Font = Enum.Font.SourceSans
hideUIButton.TextSize = 13
hideUIButton.Parent = mainFrame

-- H√†m t√¨m ng∆∞·ªùi ch∆°i g·∫ßn nh·∫•t
function findNearestPlayer()
    local nearestPlayer = nil
    local nearestDistance = math.huge
    local localCharacter = player.Character
    local localRoot = localCharacter and localCharacter:FindFirstChild("HumanoidRootPart")
    
    if not localRoot then return nil end
    
    for _, otherPlayer in pairs(Players:GetPlayers()) do
        if otherPlayer ~= player and otherPlayer.Character then
            local otherRoot = otherPlayer.Character:FindFirstChild("HumanoidRootPart")
            if otherRoot then
                local distance = (localRoot.Position - otherRoot.Position).Magnitude
                if distance < nearestDistance then
                    nearestDistance = distance
                    nearestPlayer = otherPlayer
                end
            end
        end
    end
    
    return nearestPlayer, nearestDistance
end

-- H√†m AIM (Quay camera nh√¨n v√†o ƒë·ªëi th·ªß)
function aimAtPlayer(targetPlayer)
    if not targetPlayer or not targetPlayer.Character then return end
    
    local targetRoot = targetPlayer.Character:FindFirstChild("HumanoidRootPart")
    local targetHead = targetPlayer.Character:FindFirstChild("Head")
    
    if not targetRoot and not targetHead then return end
    
    local targetPosition = targetHead and targetHead.Position or targetRoot.Position
    
    -- T√≠nh to√°n h∆∞·ªõng nh√¨n
    local camera = Workspace.CurrentCamera
    if camera then
        -- T√≠nh vector t·ª´ camera ƒë·∫øn m·ª•c ti√™u
        local direction = (targetPosition - camera.CFrame.Position).Unit
        
        -- T·∫°o CFrame m·ªõi nh√¨n v√†o m·ª•c ti√™u
        local newCFrame = CFrame.new(camera.CFrame.Position, camera.CFrame.Position + direction)
        
        -- √Åp d·ª•ng v√†o camera (AIM)
        camera.CFrame = newCFrame
    end
end

-- H√†m click v√†o v·ªã tr√≠ (gi·∫£ l·∫≠p mouse click)
function clickAtPosition()
    if isAutoAiming then
        local nearestPlayer = findNearestPlayer()
        if nearestPlayer then
            aimAtPlayer(nearestPlayer)
        end
    end
    
    -- Gi·∫£ l·∫≠p click chu·ªôt
    if UserInputService then
        -- T·∫°o s·ª± ki·ªán mouse button down v√† up
        local mouse = player:GetMouse()
        
        -- Fire click event (c·∫ßn s·ª≠ d·ª•ng ph∆∞∆°ng ph√°p t∆∞∆°ng th√≠ch v·ªõi executor)
        pcall(function()
            -- Ph∆∞∆°ng ph√°p 1: S·ª≠ d·ª•ng mouse1click
            if mouse and mouse.Target then
                local args = {
                    [1] = mouse.Target,
                    [2] = mouse.Hit
                }
                
                -- Ph∆∞∆°ng ph√°p ph·ªï bi·∫øn cho c√°c executor
                game:GetService("ReplicatedStorage"):FindFirstChild("ClickEvent") and 
                game:GetService("ReplicatedStorage").ClickEvent:FireServer(unpack(args))
            end
            
            -- Ph∆∞∆°ng ph√°p 2: Gi·∫£ l·∫≠p input
            local input = {
                UserInputType = Enum.UserInputType.MouseButton1,
                KeyCode = Enum.KeyCode.ButtonR2,
                Position = Vector2.new(mouse.X, mouse.Y)
            }
            
            UserInputService:GetPropertyChangedSignal("MouseEnabled"):Wait()
        end)
    end
end

-- Ch·ª©c nƒÉng Auto Click
function toggleAutoClick()
    isAutoClicking = not isAutoClicking
    
    if isAutoClicking then
        autoClickButton.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
        autoClickButton.Text = "üî´ AUTO CLICK: ON"
        
        -- K·∫øt n·ªëi render step ƒë·ªÉ t·ª± ƒë·ªông click
        connection1 = RunService.RenderStepped:Connect(function()
            local nearestPlayer = findNearestPlayer()
            if nearestPlayer then
                clickAtPosition()
            end
        end)
    else
        autoClickButton.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
        autoClickButton.Text = "üî´ AUTO CLICK: OFF"
        
        if connection1 then
            connection1:Disconnect()
            connection1 = nil
        end
    end
end

-- Ch·ª©c nƒÉng Auto Aim
function toggleAutoAim()
    isAutoAiming = not isAutoAiming
    
    if isAutoAiming then
        autoAimButton.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
        autoAimButton.Text = "üéØ AUTO AIM: ON"
        
        -- K·∫øt n·ªëi render step ƒë·ªÉ t·ª± ƒë·ªông aim
        connection2 = RunService.RenderStepped:Connect(function()
            local nearestPlayer = findNearestPlayer()
            if nearestPlayer then
                aimAtPlayer(nearestPlayer)
            end
        end)
    else
        autoAimButton.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
        autoAimButton.Text = "üéØ AUTO AIM: OFF"
        
        if connection2 then
            connection2:Disconnect()
            connection2 = nil
        end
    end
end

-- Ch·ª©c nƒÉng ·∫©n/hi·ªán UI
function toggleUI()
    isUIVisible = not isUIVisible
    mainFrame.Visible = isUIVisible
    
    if isUIVisible then
        hideUIButton.Text = "üëÅÔ∏è HIDE UI"
        hideUIButton.BackgroundColor3 = Color3.fromRGB(80, 60, 80)
    else
        hideUIButton.Text = "üëÅÔ∏è SHOW UI"
        hideUIButton.BackgroundColor3 = Color3.fromRGB(60, 80, 60)
    end
end

-- K·∫øt n·ªëi s·ª± ki·ªán click cho n√∫t
autoClickButton.MouseButton1Click:Connect(toggleAutoClick)
autoAimButton.MouseButton1Click:Connect(toggleAutoAim)
hideUIButton.MouseButton1Click:Connect(toggleUI)

-- Th√™m hi·ªáu ·ª©ng hover cho n√∫t
local function setupButtonHover(button)
    button.MouseEnter:Connect(function()
        if (button == autoClickButton and not isAutoClicking) or
           (button == autoAimButton and not isAutoAiming) or
           (button == hideUIButton) then
            button.BackgroundColor3 = button.BackgroundColor3 + Color3.fromRGB(20, 20, 20)
        end
    end)
    
    button.MouseLeave:Connect(function()
        if button == autoClickButton then
            button.BackgroundColor3 = isAutoClicking and Color3.fromRGB(0, 150, 0) or Color3.fromRGB(60, 60, 80)
        elseif button == autoAimButton then
            button.BackgroundColor3 = isAutoAiming and Color3.fromRGB(150, 0, 0) or Color3.fromRGB(60, 60, 80)
        elseif button == hideUIButton then
            button.BackgroundColor3 = isUIVisible and Color3.fromRGB(80, 60, 80) or Color3.fromRGB(60, 80, 60)
        end
    end)
end

setupButtonHover(autoClickButton)
setupButtonHover(autoAimButton)
setupButtonHover(hideUIButton)

-- Hotkey ƒë·ªÉ ·∫©n/hi·ªán UI (Ctrl+H)
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed then
        if input.KeyCode == Enum.KeyCode.H and UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then
            toggleUI()
        elseif input.KeyCode == Enum.KeyCode.F1 then
            toggleAutoClick()
        elseif input.KeyCode == Enum.KeyCode.F2 then
            toggleAutoAim()
        end
    end
end)

-- Th√¥ng b√°o khi script ch·∫°y
print("=========================================")
print("üü• AM BOT v2.0 LOADED SUCCESSFULLY üü•")
print("=========================================")
print("Features:")
print("üî´ Auto Click: Automatically clicks nearest player")
print("üéØ Auto Aim: Locks camera onto nearest player")
print("üëÅÔ∏è Hide UI Button: Toggle UI visibility")
print("")
print("Hotkeys:")
print("Ctrl + H: Hide/Show UI")
print("F1: Toggle Auto Click")
print("F2: Toggle Auto Aim")
print("=========================================")

-- Th√™m watermark
local watermark = Instance.new("TextLabel")
watermark.Size = UDim2.new(0, 200, 0, 20)
watermark.Position = UDim2.new(1, -210, 0, 10)
watermark.BackgroundTransparency = 1
watermark.TextColor3 = Color3.fromRGB(255, 100, 100)
watermark.Text = "AM BOT v2.0 | By Alo"
watermark.Font = Enum.Font.SourceSans
watermark.TextSize = 14
watermark.TextStrokeTransparency = 0.5
watermark.Parent = screenGui